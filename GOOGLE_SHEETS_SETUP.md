# üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤ —Å AI —Ç—å—é—Ç–æ—Ä–æ–º –≤ Google Sheets.

---

## üéØ –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç?

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ –¥–∏–∞–ª–æ–≥–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ Google —Ç–∞–±–ª–∏—Ü—É:

| –î–∞—Ç–∞ | –í—Ä–µ–º—è | –¢–µ–º–∞ | –†–æ–ª—å | –°–æ–æ–±—â–µ–Ω–∏–µ |
|------|-------|------|------|-----------|
| 21.10.2025 | 10:30:00 | –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤–µ—Å–∞ | –£—á–µ–Ω–∏–∫ | –ü—Ä–∏–≤–µ—Ç! |
| 21.10.2025 | 10:30:05 | –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤–µ—Å–∞ | –¢—å—é—Ç–æ—Ä | –ü—Ä–∏–≤–µ—Ç! –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º... |

–í—ã —Å–º–æ–∂–µ—Ç–µ:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —É—á–µ–Ω–∏–∫–æ–≤
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏
- –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–µ–º–∞–º –∏ –¥–∞—Ç–∞–º
- –î–µ–ª–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—É—á–µ–Ω–∏—è

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ Google Cloud –ø—Ä–æ–µ–∫—Ç

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google Cloud Console](https://console.cloud.google.com/)
2. –ù–∞–∂–º–∏—Ç–µ **"Create Project"**
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: `Math Tutor AI` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ)
4. –ù–∞–∂–º–∏—Ç–µ **"Create"**

### –®–∞–≥ 2: –í–∫–ª—é—á–∏—Ç–µ Google Sheets API

1. –í –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **"APIs & Services"** ‚Üí **"Library"**
2. –ù–∞–π–¥–∏—Ç–µ **"Google Sheets API"**
3. –ù–∞–∂–º–∏—Ç–µ **"Enable"**
4. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤–∫–ª—é—á–∏—Ç–µ **"Google Drive API"**

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ Service Account

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"APIs & Services"** ‚Üí **"Credentials"**
2. –ù–∞–∂–º–∏—Ç–µ **"+ CREATE CREDENTIALS"** ‚Üí **"Service account"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Service account name**: `math-tutor-bot`
   - **Service account ID**: (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è)
4. –ù–∞–∂–º–∏—Ç–µ **"CREATE AND CONTINUE"**
5. –ù–∞ —à–∞–≥–µ **"Grant this service account access to project"** –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å:
   - **Role**: `Editor` (–∏–ª–∏ `Viewer` + permissions –¥–ª—è Sheets)
6. –ù–∞–∂–º–∏—Ç–µ **"DONE"**

### –®–∞–≥ 4: –°–∫–∞—á–∞–π—Ç–µ JSON –∫–ª—é—á

1. –í —Å–ø–∏—Å–∫–µ **Service Accounts** –Ω–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–∏ —Ç–æ—á–∫–∏ (‚ãÆ) —Å–ø—Ä–∞–≤–∞ ‚Üí **"Manage keys"**
3. –ù–∞–∂–º–∏—Ç–µ **"ADD KEY"** ‚Üí **"Create new key"**
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø **JSON**
5. –ù–∞–∂–º–∏—Ç–µ **"CREATE"** - —Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ! –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ –µ–≥–æ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ.

### –®–∞–≥ 5: –°–æ–∑–¥–∞–π—Ç–µ Google —Ç–∞–±–ª–∏—Ü—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Sheets](https://sheets.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É
3. –ù–∞–∑–æ–≤–∏—Ç–µ –µ—ë: **"Math Tutor Dialogs"** (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏–º—è)
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **URL** —Ç–∞–±–ª–∏—Ü—ã (–∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏)

### –®–∞–≥ 6: –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø Service Account –∫ —Ç–∞–±–ª–∏—Ü–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π JSON —Ñ–∞–π–ª –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `"client_email"` - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ email (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `math-tutor-bot@....iam.gserviceaccount.com`)
3. –í –≤–∞—à–µ–π Google —Ç–∞–±–ª–∏—Ü–µ –Ω–∞–∂–º–∏—Ç–µ **"Share"** (–ü–æ–¥–µ–ª–∏—Ç—å—Å—è)
4. –í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π email
5. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞: **"Editor"** (–†–µ–¥–∞–∫—Ç–æ—Ä)
6. –°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É **"Notify people"** (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –Ω—É–∂–Ω–æ)
7. –ù–∞–∂–º–∏—Ç–µ **"Share"**

### –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç A: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (.env —Ñ–∞–π–ª)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à `.env` —Ñ–∞–π–ª
2. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```bash
# Google Sheets –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
GOOGLE_SHEETS_CREDENTIALS='{"type":"service_account","project_id":"...","private_key":"...","client_email":"..."}'
GOOGLE_SHEET_NAME="Math Tutor Dialogs"
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å JSON —Å—Ç—Ä–æ–∫—É:**
- –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π JSON —Ñ–∞–π–ª
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–≤–µ—Å—å** –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–æ—Ç `{` –¥–æ `}`)
- –í—Å—Ç–∞–≤—å—Ç–µ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –ø–æ—Å–ª–µ `GOOGLE_SHEETS_CREDENTIALS='`
- –ó–∞–∫—Ä–æ–π—Ç–µ –æ–¥–∏–Ω–∞—Ä–Ω–æ–π –∫–∞–≤—ã—á–∫–æ–π `'`

**–ü—Ä–∏–º–µ—Ä:**
```bash
GOOGLE_SHEETS_CREDENTIALS='{"type":"service_account","project_id":"math-tutor-ai","private_key_id":"abc123...","private_key":"-----BEGIN PRIVATE KEY-----\nMIIE...","client_email":"math-tutor-bot@math-tutor-ai.iam.gserviceaccount.com","client_id":"1234567890"}'
GOOGLE_SHEET_NAME="Math Tutor Dialogs"
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: Streamlit Cloud

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ [Streamlit Cloud](https://share.streamlit.io/)
2. –ù–∞–∂–º–∏—Ç–µ **"‚öôÔ∏è Settings"** ‚Üí **"Secrets"**
3. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ TOML:

```toml
# Google Sheets
GOOGLE_SHEETS_CREDENTIALS = '{"type":"service_account","project_id":"...","private_key":"...","client_email":"..."}'
GOOGLE_SHEET_NAME = "Math Tutor Dialogs"
```

4. –ù–∞–∂–º–∏—Ç–µ **"Save"**
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π –¥–∏–∞–ª–æ–≥
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üìä –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Google Sheets"**
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à—É Google —Ç–∞–±–ª–∏—Ü—É - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏

---

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—á–µ–Ω–∏–∫–æ–≤) –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –Ω–∏—Ö –æ—Ç–¥–µ–ª—å–Ω–æ.

**–í –∫–æ–¥–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å URL —Ç–∞–±–ª–∏—Ü—ã:**

```python
from utils import save_chat_to_sheets

save_chat_to_sheets(
    messages=messages,
    sheet_url="https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit",
    topic_title="–¢–µ–º–∞ —É—Ä–æ–∫–∞"
)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ —Ö—Ä–∞–Ω–∏—Ç—å JSON –≤ .env, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –∫–∞–∫ —Ñ–∞–π–ª:

1. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ `google-credentials.json`
2. –ü–æ–ª–æ–∂–∏—Ç–µ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ (—Ä—è–¥–æ–º —Å `streamlit_app.py`)
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`:
   ```
   google-credentials.json
   ```
4. –í `.env` —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å:
   ```bash
   GOOGLE_SHEETS_CREDENTIALS="/path/to/google-credentials.json"
   ```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå "–¢–∞–±–ª–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –¥–∞–ª–∏ –¥–æ—Å—Ç—É–ø Service Account email –∫ —Ç–∞–±–ª–∏—Ü–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ `GOOGLE_SHEET_NAME`

### ‚ùå "–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å JSON –≤ `GOOGLE_SHEETS_CREDENTIALS`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã Google Sheets API –∏ Google Drive API

### ‚ùå "Permission denied"
- Service Account –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ **Editor** –Ω–∞ —Ç–∞–±–ª–∏—Ü—É
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –ø–æ–¥–µ–ª–∏–ª–∏—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º email

### ‚ùå –ù–∞ Streamlit Cloud –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ TOML (–Ω–µ .env)
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üéì –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Google Cloud Console](https://console.cloud.google.com/)
- [Google Sheets API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://developers.google.com/sheets/api)
- [gspread –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.gspread.org/)
- [Streamlit Secrets Management](https://docs.streamlit.io/streamlit-community-cloud/deploy-your-app/secrets-management)

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ JSON credentials –≤ Git
2. **–ë—ç–∫–∞–ø**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∫–∞–∫ Excel –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
3. **–ê–Ω–∞–ª–∏–∑**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Google Sheets —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —É—á–µ–Ω–∏–∫–æ–≤
4. **–§–∏–ª—å—Ç—Ä—ã**: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–µ–º–∞–º –∏ –¥–∞—Ç–∞–º –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

---

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ Issue –Ω–∞ GitHub! üöÄ
